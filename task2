from subprocess import call
import sys
import os
import glob
import filecmp
import schedule
import time


def check(path1, path2, path3):
    comp = filecmp.cmp(path1, path2, shallow=True)
    # Comparison of files on two folders, if they aren't the same the replica folder's content is removed and then the
    # content of the source file is copied here.
    if comp is True:
        pass
        print("Content of both folder is the same!", file=open(path3, 'a'))
    else:
        files = glob.glob(path2 + "\\" + '*')
        for f in files:
            os.remove(f)
    print("Files from: " + path1 + " sent to: " + path2, file=open(path3, 'a'))
    try:
        call(["robocopy", path1, path2, "/MIR"])
        print("The content of both libraries is now the same!", file=open(path3, 'a'))
    finally:
        pass


def s(interval):  # s stands for schedule
    schedule.every(interval).minutes.do(check)
    while 1:
        schedule.run_pending()
        time.sleep(1)


if sys.argv[1] == "-c":
    check(sys.argv[2], sys.argv[3], sys.argv[5])
    s(sys.argv[4])
